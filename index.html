<!DOCTYPE html>
<html lang="ne">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Aruns E-Services Portal â€” Updated Final Version</title>

  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:"Segoe UI",Arial,sans-serif;background:#f0f4fb;color:#333;min-height:100vh;display:flex;flex-direction:column;}

    /* LOGIN */
    #loginPage{display:flex;justify-content:center;align-items:center;flex:1;background:linear-gradient(120deg,#cfd6dd,#d5e0e9);padding:30px;}
    .login-box{background:#fff;padding:26px;border-radius:10px;box-shadow:0 0 20px rgba(0,0,0,0.18);width:340px;text-align:center;}
    .login-box h2{margin-bottom:12px;color:#003366;font-size:20px;}
    .login-box input{width:100%;padding:10px;margin:8px 0;border:1px solid #cfd6e6;border-radius:6px;font-size:15px;}
    .login-box button{width:100%;padding:10px;background:#003366;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:16px;}
    .login-box button:hover{background:#0055aa;}
    .error-msg{color:#b00020;font-size:13px;display:none;margin-top:6px;}

    /* MAIN PAGE */
    #mainPage{display:none;flex-direction:column;min-height:100vh;}
    header{background:linear-gradient(90deg,#001f3f,#004b8d);color:#fff;display:flex;align-items:center;justify-content:space-between;padding:8px 20px;box-shadow:0 2px 10px rgba(0,0,0,0.18);}
    header img.logo{height:55px;border-radius:6px;}
    header .title{text-align:center;flex-grow:1;}
    header .title h1{font-size:20px;margin-bottom:4px;}
    .time-box{
      display:flex;flex-direction:column;align-items:center;padding:6px 12px;border-radius:10px;
      background:linear-gradient(135deg,#003366,#0077cc);
      border:2px solid rgba(0,255,255,0.15);
      box-shadow:0 0 10px rgba(0,255,255,0.12);
      min-width:130px;
      color:#e8f7ff;
      font-size:13px;
    }

    .container{display:grid;grid-template-columns:250px 1fr;flex:1;height:calc(100vh - 160px);}
    .sidebar{background:#e9eff7;border-right:2px solid #c3cbe0;padding:12px;overflow-y:auto;}
    .sidebar h3{color:#003366;margin-bottom:10px;font-size:16px;}
    .folder>div{cursor:pointer;padding:8px 10px;border-radius:6px;display:flex;align-items:center;justify-content:space-between;color:#003366;}
    .folder ul{margin-left:6px;margin-top:8px;list-style:none;display:none;padding-left:6px;}
    .folder.open>ul{display:block;}
    .folder ul li a{text-decoration:none;color:#003366;display:block;padding:6px 8px;border-radius:6px;}
    .folder ul li a:hover{background:#c7d7f0;}

    main{background:#fff;}
    iframe{width:100%;height:100%;border:none;}

    footer.main-footer{background:#002b5c;color:#fff;text-align:center;font-size:13px;padding:12px;display:flex;align-items:center;justify-content:space-between;gap:12px;}
    .footer-actions button{padding:8px 12px;margin-left:8px;background:#004b8d;color:#fff;border:none;border-radius:6px;cursor:pointer;}
    .footer-actions button.total{background:#006400;}

    /* POPUP */
    #confirmPopup{
      position:fixed;top:0;left:0;width:100%;height:100%;
      background:rgba(0,0,0,0.55);display:none;
      justify-content:center;align-items:center;z-index:99999;
    }
    #confirmBox{
      background:white;width:320px;padding:22px;border-radius:12px;
      text-align:center;box-shadow:0 0 25px rgba(0,0,0,0.25);
      animation:pop .25s ease-out;
    }
    @keyframes pop{
      from{transform:scale(.7);opacity:0;}
      to{transform:scale(1);opacity:1;}
    }
    #confirmBox h3{margin-bottom:14px;color:#222;}
    .popup-btn{
      padding:8px 14px;border:none;border-radius:6px;margin:6px;font-size:15px;cursor:pointer;
    }
    .yes-btn{background:#0a7f00;color:#fff;}
    .no-btn{background:#9b0000;color:#fff;}

    /* TOAST */
    #toast {visibility:hidden;min-width:220px;max-width:420px;background:linear-gradient(135deg,#003366,#00aaff);color:#fff;text-align:center;border-radius:8px;padding:12px 18px;position:fixed;top:20px;right:20px;font-size:14px;box-shadow:0 0 12px rgba(0,255,255,0.18);opacity:0;transform:translateY(-10px);transition:opacity 0.35s, transform 0.35s;z-index:9999;}
    #toast.show {visibility:visible;opacity:1;transform:translateY(0);}
  </style>
</head>
<body>

<!-- POPUP -->
<div id="confirmPopup">
  <div id="confirmBox">
    <h3 id="confirmMsg">Are you sure?</h3>
    <button class="popup-btn yes-btn" id="popupYes">Yes</button>
    <button class="popup-btn no-btn" id="popupNo">Cancel</button>
  </div>
</div>

<!-- LOGIN PAGE -->
<div id="loginPage">
  <div class="login-box">
    <h2>ğ‹ğ¨ğ  ğˆğ§ ğŸ”</h2>
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <div class="error-msg" id="error">âŒ Invalid Username or Password</div>
    <button id="loginBtn">Login</button>
  </div>
</div>

<!-- MAIN -->
<div id="mainPage" aria-hidden="true">

  <header>
    <div style="display:flex;align-items:center;gap:12px;">
      <img class="logo" src="https://upload.wikimedia.org/wikipedia/commons/5/5b/Bajaj_logo.jpg">
      <div class="time-box">
        <div id="engTime">Loading...</div>
        <div id="nepTime">à¤¨à¥‡à¤ªà¤¾à¤²à¥€ à¤®à¤¿à¤¤à¤¿...</div>
      </div>
    </div>

    <div class="title">
      <h1>ğŸŒ ğ—ğ—”ğ—•ğ—˜ğ—šğ—¨ğ—›ğ—”ğ—¡ğ—š ğ— ğ—¨ğ—Ÿğ—§ğ—œ ğ—£ğ—¨ğ—¥ğ—£ğ—¢ğ—¦ğ—˜ ğ—–ğ—¢ğ— ğ—£ğ—”ğ—¬ ğŸŒ</h1>
      <p class="hint">Database With Cloud Department</p>
    </div>

    <img class="logo" src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Animated-nepal-flag-image-0007.gif">
    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b9/Small_gif.gif" style="height:60px;">
  </header>

  <div class="container">
    <div class="sidebar">
      <h3>ğğ§ğ¥ğ¢ğ§ğ ğ„-ğ’ğğ«ğ¯ğ¢ğœğğ¬</h3>

      <div class="folder">
        <div onclick="toggleFolder(this)">ğŸ“ Cash Records <span>â–¸</span></div>
        <ul>
         <li><a href="#" onclick="loadEsewaForm();return false;">ğŸ— Cash Transaction</a></li>
         <li><a href="#" onclick="loadEsewaForm();return false;">ğŸ— Statement Report</a></li>
        </ul>
      </div>

      <div class="folder">
        <div onclick="toggleFolder(this)">ğŸ“ Inquiry-Footfall <span>â–¸</span></div>
        <ul>
          <li><a href="Online E-Services/Collector/collector-details.html" target="contentFrame">ğŸ— Inquiry Form</a></li>
          <li><a href="Online E-Services/Collector/collector-download.html" target="contentFrame">ğŸ— Record Download</a></li>
        </ul>
      </div>

      <div class="folder">
        <div onclick="toggleFolder(this)">ğŸ“ Vehicle Order Record <span>â–¸</span></div>
        <ul>
          <li><a href="Online E-Services/Banks/bank-statement-update.html" target="contentFrame">ğŸ— Order Updates</a></li>
          <li><a href="Online E-Services/Banks/statement-download.html" target="contentFrame">ğŸ— Order Statement</a></li>
        </ul>
      </div>

    </div>

    <main>
      <iframe id="contentFrame" name="contentFrame"></iframe>
    </main>
  </div>

  <footer class="main-footer">
    <div class="footer-left">
      <div>Â© 2025 Database With Cloud Department</div>
      <div style="font-size:12px;opacity:0.85;">(Logged in as <strong id="whoami">admin</strong>)</div>
    </div>

    <div class="footer-actions">
      <!-- ONLY TOTAL BACKUP / RESTORE -->
      <button id="totalBackupBtn" class="total">ğŸ“¦ Total Backup</button>
      <button id="totalRestoreBtn" class="total">ğŸ§­ Total Restore</button>
      <button id="logoutBtn" style="background:#b02a2a;">ğŸ”’ Logout</button>
    </div>
  </footer>

</div>

<div id="toast">Status</div>

<script>
/* Popup handler */
let popupAction = null;
function askConfirm(msg, action){
  popupAction = action;
  document.getElementById("confirmMsg").textContent = msg;
  document.getElementById("confirmPopup").style.display="flex";
}
document.getElementById("popupYes").onclick = ()=>{
  document.getElementById("confirmPopup").style.display="none";
  if(popupAction) popupAction();
};
document.getElementById("popupNo").onclick = ()=>{
  document.getElementById("confirmPopup").style.display="none";
};

/* Toast */
function showToast(msg){
  const t=document.getElementById("toast");
  t.textContent=msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),3000);
}

/* LOGIN */
document.getElementById('loginBtn').onclick = ()=>{
  const u=document.getElementById('username').value.trim();
  const p=document.getElementById('password').value.trim();
  if(u.toLowerCase()==="admin" && p==="Admin123"){
    loginPage.style.display="none";
    mainPage.style.display="flex";
    whoami.textContent=u;
    showToast("Welcome!");
    loadDashboard();
  } else {
    error.style.display="block";
    setTimeout(()=>error.style.display="none",3000);
  }
};

logoutBtn.onclick = ()=>{
  mainPage.style.display="none";
  loginPage.style.display="flex";
  contentFrame.srcdoc="";
};

/* Sidebar */
function toggleFolder(e){ e.parentElement.classList.toggle("open"); }

/* Dummy loaders */
function loadEsewaForm(){
  contentFrame.srcdoc="<h2 style='padding:20px;'>Esewa Form Placeholder</h2>";
}

/* Dashboard */
function safeParseLocal(k){
  try{
    let r=localStorage.getItem(k);
    if(!r) return [];
    const p=JSON.parse(r);
    return Array.isArray(p)?p:[p];
  }catch(e){return [];}
}
function loadDashboard(){
  contentFrame.srcdoc="<h2 style='padding:20px;text-align:center;'>Dashboard Loaded</h2>";
}

/* TOTAL BACKUP (single file overwrite) */
function totalBackupNow(){
  try{
    const out={_meta:{date:new Date().toISOString()}};
    for(let i=0;i<localStorage.length;i++){
      let k=localStorage.key(i);
      out[k]=localStorage.getItem(k);
    }
    const blob=new Blob([JSON.stringify(out,null,2)],{type:"application/json"});
    const a=document.createElement("a");
    a.href=URL.createObjectURL(blob);
    a.download="Backup.json"; 
    a.click();
    showToast("Backup.json successfully overwritten.");
  }catch(e){
    showToast("Backup failed.");
  }
}

/* TOTAL RESTORE */
function totalRestoreNow(){
  const inp=document.createElement("input");
  inp.type="file";
  inp.accept="application/json";
  inp.onchange=e=>{
    const file=e.target.files[0];
    if(!file) return;
    const r=new FileReader();
    r.onload=ev=>{
      try{
        const data=JSON.parse(ev.target.result);
        localStorage.clear();
        for(const k in data){ localStorage.setItem(k,data[k]); }
        showToast("Total Restore Completed.");
        loadDashboard();
      }catch{
        showToast("Invalid File.");
      }
    };
    r.readAsText(file);
  };
  inp.click();
}

/* Attach with confirmation popup */
totalBackupBtn.onclick = ()=> askConfirm("Create Backup.json and overwrite old file?", totalBackupNow);
totalRestoreBtn.onclick = ()=> askConfirm("Restore all data from selected Backup.json?", totalRestoreNow);

/* Clock */
function updateHeaderTime(){
  const now=new Date();
  engTime.textContent=now.toLocaleString();
  nepTime.textContent="à¤¨à¥‡à¤ªà¤¾à¤²à¥€ à¤®à¤¿à¤¤à¤¿ " + now.getSeconds();
}
setInterval(updateHeaderTime,1000);
updateHeaderTime();
</script>

</body>
</html>
